\subsection{list\+\_\+iterator.\+c}
\label{a00113_source}\index{src/list\+\_\+iterator.\+c@{src/list\+\_\+iterator.\+c}}

\begin{DoxyCode}
00001 
00002 \textcolor{comment}{//}
00003 \textcolor{comment}{// iterator.c}
00004 \textcolor{comment}{//}
00005 \textcolor{comment}{// Copyright (c) 2010 TJ Holowaychuk <tj@vision-media.ca>}
00006 \textcolor{comment}{//}
00007 
00008 \textcolor{preprocessor}{#include "list.h"}
00009 
00010 \textcolor{comment}{/*}
00011 \textcolor{comment}{ * Allocate a new list\_iterator\_t. NULL on failure.}
00012 \textcolor{comment}{ * Accepts a direction, which may be LIST\_HEAD or LIST\_TAIL.}
00013 \textcolor{comment}{ */}
00014 
00015 list_iterator_t *list_iterator_new(list_t *list, list_direction_t direction) \{
00016   list_node_t *node = direction == LIST_HEAD ? list->head : list->tail;
00017   \textcolor{keywordflow}{return} list_iterator_new_from_node(node, direction);
00018 \}
00019 
00020 \textcolor{comment}{/*}
00021 \textcolor{comment}{ * Allocate a new list\_iterator\_t with the given start}
00022 \textcolor{comment}{ * node. NULL on failure.}
00023 \textcolor{comment}{ */}
00024 
00025 list_iterator_t *list_iterator_new_from_node(list_node_t *node,
00026                                              list_direction_t direction) \{
00027   list_iterator_t *\textcolor{keyword}{self};
00028   \textcolor{keywordflow}{if} (!(\textcolor{keyword}{self} = LIST_MALLOC(\textcolor{keyword}{sizeof}(list_iterator_t))))
00029     \textcolor{keywordflow}{return} NULL;
00030   \textcolor{keyword}{self}->next = node;
00031   \textcolor{keyword}{self}->direction = direction;
00032   \textcolor{keywordflow}{return} \textcolor{keyword}{self};
00033 \}
00034 
00035 \textcolor{comment}{/*}
00036 \textcolor{comment}{ * Return the next list\_node\_t or NULL when no more}
00037 \textcolor{comment}{ * nodes remain in the list.}
00038 \textcolor{comment}{ */}
00039 
00040 list_node_t *list_iterator_next(list_iterator_t *\textcolor{keyword}{self}) \{
00041   list_node_t *curr = \textcolor{keyword}{self}->next;
00042   \textcolor{keywordflow}{if} (curr) \{
00043     \textcolor{keyword}{self}->next = \textcolor{keyword}{self}->direction == LIST_HEAD ? curr->next : curr->prev;
00044   \}
00045   \textcolor{keywordflow}{return} curr;
00046 \}
00047 
00048 \textcolor{comment}{/*}
00049 \textcolor{comment}{ * Free the list iterator.}
00050 \textcolor{comment}{ */}
00051 
00052 \textcolor{keywordtype}{void} list_iterator_destroy(list_iterator_t *\textcolor{keyword}{self}) \{
00053   LIST_FREE(\textcolor{keyword}{self});
00054   \textcolor{keyword}{self} = NULL;
00055 \}
\end{DoxyCode}
