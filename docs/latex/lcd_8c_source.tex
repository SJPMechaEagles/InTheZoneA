\subsection{lcd.\+c}
\label{lcd_8c_source}\index{src/lcd.\+c@{src/lcd.\+c}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "lcd.h"}
00002 
00004 \textcolor{keyword}{static} FILE *lcd_port = NULL;
00005 
00013  \textcolor{keyword}{static} \textcolor{keywordtype}{void} lcd_assert() \{
00014   \textcolor{keywordflow}{if}(lcd_port != NULL) \{
00015     printf(\textcolor{stringliteral}{"LCD NULL!"});
00016     exit(1);
00017   \}
00018 \}
00019 
00027 lcd_buttons lcd_get_pressed_buttons()\{
00028   lcd_assert();
00029   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} btn\_binary = lcdReadButtons(lcd_port);
00030   \textcolor{keywordtype}{bool} left = btn\_binary & 0x1;\textcolor{comment}{//0001}
00031   \textcolor{keywordtype}{bool} middle = btn\_binary & 0x2;\textcolor{comment}{//0010}
00032   \textcolor{keywordtype}{bool} right = btn\_binary & 0x4;\textcolor{comment}{//0100}
00033   lcd_buttons btns;
00034   btns.left = left ? PRESSED : RELEASED;
00035   btns.middle = middle ? PRESSED : RELEASED;
00036   btns.right = right ? PRESSED : RELEASED;
00037 
00038   \textcolor{keywordflow}{return} btns;
00039 \}
00040 
00046 \textcolor{keywordtype}{void} lcd_clear() \{
00047   lcd_assert();
00048   lcdClear(lcd_port);
00049 \}
00050 
00060 \textcolor{keywordtype}{void} init_main_lcd(FILE *lcd) \{
00061   lcdInit(lcd);
00062   lcdClear(lcd);
00063   lcd_port = lcd;
00064 \}
00065 
00073 \textcolor{keywordtype}{void} lcd_print(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str) \{
00074   lcd_assert();
00075   lcdSetText(lcd_port, line, str);
00076 \}
00077 
00085 \textcolor{keywordtype}{void} lcd_printf(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} line, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *format\_str, ...) \{
00086   lcd_assert();
00087   lcdPrint(lcd_port, line, format\_str);
00088 \}
00089 
00096 \textcolor{keywordtype}{void} lcd_set_backlight(\textcolor{keywordtype}{bool} state) \{
00097   lcd_assert();
00098   lcdSetBacklight(lcd_port, state);
00099 \}
00100 
00110 \textcolor{keywordtype}{void} promt_confirmation(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *confirm\_text) \{
00111   lcd_assert();
00112   lcd_print(1, confirm\_text);
00113   \textcolor{keywordflow}{while}(lcd_get_pressed_buttons().middle != PRESSED)\{
00114     delay(200);
00115   \}
00116 \}
\end{DoxyCode}
