\hypertarget{slew_8c}{}\section{src/slew.c File Reference}
\label{slew_8c}\index{src/slew.\+c@{src/slew.\+c}}
{\ttfamily \#include \char`\"{}slew.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}log.\+h\char`\"{}}\newline
Include dependency graph for slew.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{slew_8c_a981c9990a969d2587e66e550737f7cd9}{deinitslew} ()
\begin{DoxyCompactList}\small\item\em Deinitializes the slew rate controller and frees memory. \end{DoxyCompactList}\item 
void \hyperlink{slew_8c_a321758941d88b75783955c819bb75005}{init\+\_\+slew} ()
\begin{DoxyCompactList}\small\item\em Initializes the slew rate controller. \end{DoxyCompactList}\item 
void \hyperlink{slew_8c_a9f8b8ae577ef938622024545711f0151}{set\+\_\+motor\+\_\+immediate} (int motor, int speed)
\item 
void \hyperlink{slew_8c_a7dff2b79dffe55fb936d977594d7c01d}{set\+\_\+motor\+\_\+slew} (int motor, int speed)
\begin{DoxyCompactList}\small\item\em Sets motor speed wrapped inside the slew rate controller. \end{DoxyCompactList}\item 
void \hyperlink{slew_8c_a807a87c5df438fde21c1e8213906695b}{update\+Motors} ()
\begin{DoxyCompactList}\small\item\em Closes the distance between the desired motor value and the current motor value by half for each motor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static bool \hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized} = false
\item 
static int \hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\+\_\+curr\+\_\+speeds} \mbox{[}10\mbox{]}
\item 
static int \hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\+\_\+set\+\_\+speeds} \mbox{[}10\mbox{]}
\item 
static \hyperlink{_a_p_i_8h_a23dca3c0de10682afb982677ff292f77}{Task\+Handle} \hyperlink{slew_8c_a9dc30877eadbb32ceb6bede027c9a93f}{slew} = N\+U\+LL
\item 
static \hyperlink{_a_p_i_8h_a9b40607ca13d2b5261f47f613e3c4fa4}{Mutex} \hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\+\_\+mutex}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{slew_8c_a981c9990a969d2587e66e550737f7cd9}\label{slew_8c_a981c9990a969d2587e66e550737f7cd9}} 
\index{slew.\+c@{slew.\+c}!deinitslew@{deinitslew}}
\index{deinitslew@{deinitslew}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{deinitslew()}{deinitslew()}}
{\footnotesize\ttfamily void deinitslew (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Deinitializes the slew rate controller and frees memory. 

\begin{DoxyAuthor}{Author}
Chris Jerrett 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
9/14/17 
\end{DoxyDate}


Definition at line 43 of file slew.\+c.



References initialized, motors\+\_\+curr\+\_\+speeds, motors\+\_\+set\+\_\+speeds, slew, and task\+Delete().



Referenced by autonomous().


\begin{DoxyCode}
43                  \{
44   \hyperlink{_a_p_i_8h_add3b8d580ea6ef5635c6d9ff88c68612}{taskDelete}(\hyperlink{slew_8c_a9dc30877eadbb32ceb6bede027c9a93f}{slew});
45   memset(\hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 10);
46   memset(\hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 10);
47   \hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized} = \textcolor{keyword}{false};
48 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=239pt]{slew_8c_a981c9990a969d2587e66e550737f7cd9_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{slew_8c_a981c9990a969d2587e66e550737f7cd9_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{slew_8c_a321758941d88b75783955c819bb75005}\label{slew_8c_a321758941d88b75783955c819bb75005}} 
\index{slew.\+c@{slew.\+c}!init\+\_\+slew@{init\+\_\+slew}}
\index{init\+\_\+slew@{init\+\_\+slew}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{init\+\_\+slew()}{init\_slew()}}
{\footnotesize\ttfamily void init\+\_\+slew (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Initializes the slew rate controller. 

\begin{DoxyAuthor}{Author}
Chris Jerrett, Christian De\+Simone 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
9/14/17 
\end{DoxyDate}


Definition at line 30 of file slew.\+c.



References info(), initialized, motors\+\_\+curr\+\_\+speeds, motors\+\_\+set\+\_\+speeds, motor\+Stop\+All(), mutex\+Create(), slew, speeds\+\_\+mutex, task\+Run\+Loop(), update\+Motors(), and warning().



Referenced by autonomous(), operator\+Control(), set\+\_\+motor\+\_\+immediate(), and set\+\_\+motor\+\_\+slew().


\begin{DoxyCode}
30                 \{
31   \textcolor{keywordflow}{if}(\hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized}) \{
32     \hyperlink{log_8h_a0bec2cf5fff7f607bc510b74aba9887c}{warning}(\textcolor{stringliteral}{"Trying to init already init slew"});
33   \}
34   memset(\hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 10);
35   memset(\hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}, 0, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 10);
36   \hyperlink{_a_p_i_8h_a8966c541f3e9565aea1289f0d2f2cf43}{motorStopAll}();
37   \hyperlink{log_8h_a1606d750e1bb8de9f9e917172bba3382}{info}(\textcolor{stringliteral}{"Did Init Slew"});
38   \hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex} = \hyperlink{_a_p_i_8h_aecd027ce8f8b52a765735e9eb5b202b3}{mutexCreate}();
39   \hyperlink{slew_8c_a9dc30877eadbb32ceb6bede027c9a93f}{slew} = \hyperlink{_a_p_i_8h_ab05a241d6d1fd98b1ceb4665db678156}{taskRunLoop}(\hyperlink{slew_8c_a807a87c5df438fde21c1e8213906695b}{updateMotors}, 100);
40   \hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized} = \textcolor{keyword}{true};
41 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a321758941d88b75783955c819bb75005_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a321758941d88b75783955c819bb75005_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{slew_8c_a9f8b8ae577ef938622024545711f0151}\label{slew_8c_a9f8b8ae577ef938622024545711f0151}} 
\index{slew.\+c@{slew.\+c}!set\+\_\+motor\+\_\+immediate@{set\+\_\+motor\+\_\+immediate}}
\index{set\+\_\+motor\+\_\+immediate@{set\+\_\+motor\+\_\+immediate}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{set\+\_\+motor\+\_\+immediate()}{set\_motor\_immediate()}}
{\footnotesize\ttfamily void set\+\_\+motor\+\_\+immediate (\begin{DoxyParamCaption}\item[{int}]{motor,  }\item[{int}]{speed }\end{DoxyParamCaption})}



Definition at line 60 of file slew.\+c.



References debug(), init\+\_\+slew(), initialized, motors\+\_\+curr\+\_\+speeds, motors\+\_\+set\+\_\+speeds, motor\+Set(), mutex\+Give(), mutex\+Take(), and speeds\+\_\+mutex.



Referenced by close\+\_\+claw(), open\+\_\+claw(), set\+\_\+claw\+\_\+motor(), set\+\_\+intake\+\_\+motor(), and set\+\_\+lifter\+\_\+motors().


\begin{DoxyCode}
60                                                \{
61   \textcolor{keywordflow}{if}(!\hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized}) \{
62     \hyperlink{log_8h_af3668f40d1ad1b4f3418869ac9a31f34}{debug}(\textcolor{stringliteral}{"Slew Not Initialized! Initializing"});
63     \hyperlink{slew_8c_a321758941d88b75783955c819bb75005}{init\_slew}();
64   \}
65   \hyperlink{_a_p_i_8h_a03c5b04b472d024281f62d7af8854a8e}{motorSet}(motor, speed);
66   \hyperlink{_a_p_i_8h_a8b51124628d2a7741738d48551d1e8ee}{mutexTake}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex}, 10);
67   \hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}[motor-1] = speed;
68   \hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}[motor-1] = speed;
69   \hyperlink{_a_p_i_8h_afe171a08d22de18fc2ab604b2364959f}{mutexGive}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex});
70 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a9f8b8ae577ef938622024545711f0151_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a9f8b8ae577ef938622024545711f0151_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{slew_8c_a7dff2b79dffe55fb936d977594d7c01d}\label{slew_8c_a7dff2b79dffe55fb936d977594d7c01d}} 
\index{slew.\+c@{slew.\+c}!set\+\_\+motor\+\_\+slew@{set\+\_\+motor\+\_\+slew}}
\index{set\+\_\+motor\+\_\+slew@{set\+\_\+motor\+\_\+slew}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{set\+\_\+motor\+\_\+slew()}{set\_motor\_slew()}}
{\footnotesize\ttfamily void set\+\_\+motor\+\_\+slew (\begin{DoxyParamCaption}\item[{int}]{motor,  }\item[{int}]{speed }\end{DoxyParamCaption})}



Sets motor speed wrapped inside the slew rate controller. 


\begin{DoxyParams}{Parameters}
{\em motor} & the motor port to use \\
\hline
{\em speed} & the speed to use, between -\/127 and 127 \\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}
Chris Jerrett 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
9/14/17 
\end{DoxyDate}


Definition at line 50 of file slew.\+c.



References debug(), init\+\_\+slew(), initialized, motors\+\_\+set\+\_\+speeds, mutex\+Give(), mutex\+Take(), and speeds\+\_\+mutex.



Referenced by set\+\_\+side\+\_\+speed().


\begin{DoxyCode}
50                                          \{
51   \textcolor{keywordflow}{if}(!\hyperlink{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}{initialized}) \{
52     \hyperlink{log_8h_af3668f40d1ad1b4f3418869ac9a31f34}{debug}(\textcolor{stringliteral}{"Slew Not Initialized! Initializing"});
53     \hyperlink{slew_8c_a321758941d88b75783955c819bb75005}{init\_slew}();
54   \}
55   \hyperlink{_a_p_i_8h_a8b51124628d2a7741738d48551d1e8ee}{mutexTake}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex}, 10);
56   \hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}[motor-1] = speed;
57   \hyperlink{_a_p_i_8h_afe171a08d22de18fc2ab604b2364959f}{mutexGive}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex});
58 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a7dff2b79dffe55fb936d977594d7c01d_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a7dff2b79dffe55fb936d977594d7c01d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{slew_8c_a807a87c5df438fde21c1e8213906695b}\label{slew_8c_a807a87c5df438fde21c1e8213906695b}} 
\index{slew.\+c@{slew.\+c}!update\+Motors@{update\+Motors}}
\index{update\+Motors@{update\+Motors}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{update\+Motors()}{updateMotors()}}
{\footnotesize\ttfamily void update\+Motors (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Closes the distance between the desired motor value and the current motor value by half for each motor. 

\begin{DoxyAuthor}{Author}
Chris Jerrett 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
9/14/17 
\end{DoxyDate}


Definition at line 13 of file slew.\+c.



References motors\+\_\+curr\+\_\+speeds, motors\+\_\+set\+\_\+speeds, motor\+Set(), mutex\+Give(), mutex\+Take(), and speeds\+\_\+mutex.



Referenced by init\+\_\+slew().


\begin{DoxyCode}
13                    \{
14   \textcolor{comment}{//Take back half approach}
15   \textcolor{comment}{//Not linear but equal to setSpeed(1-(1/2)^x)}
16   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < 9; i++) \{
17     \textcolor{keywordflow}{if}(\hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}[i] == \hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}[i]) \textcolor{keywordflow}{continue};
18     \hyperlink{_a_p_i_8h_a8b51124628d2a7741738d48551d1e8ee}{mutexTake}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex}, 10);
19     \textcolor{keywordtype}{int} set\_speed = (\hyperlink{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}{motors\_set\_speeds}[i]);
20     \textcolor{keywordtype}{int} curr\_speed = \hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}[i];
21     \hyperlink{_a_p_i_8h_afe171a08d22de18fc2ab604b2364959f}{mutexGive}(\hyperlink{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}{speeds\_mutex});
22     \textcolor{keywordtype}{int} diff = set\_speed - curr\_speed;
23     \textcolor{keywordtype}{int} offset = diff;
24     \textcolor{keywordtype}{int} n = curr\_speed + offset;
25     \hyperlink{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}{motors\_curr\_speeds}[i] = n;
26     \hyperlink{_a_p_i_8h_a03c5b04b472d024281f62d7af8854a8e}{motorSet}(i+1, n);
27   \}
28 \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{slew_8c_a807a87c5df438fde21c1e8213906695b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{slew_8c_a807a87c5df438fde21c1e8213906695b_icgraph}
\end{center}
\end{figure}


\subsection{Variable Documentation}
\mbox{\Hypertarget{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}\label{slew_8c_aedeffc7d23da25d52b9a50045189fe2b}} 
\index{slew.\+c@{slew.\+c}!initialized@{initialized}}
\index{initialized@{initialized}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{initialized}{initialized}}
{\footnotesize\ttfamily bool initialized = false\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 11 of file slew.\+c.



Referenced by deinitslew(), init\+\_\+slew(), set\+\_\+motor\+\_\+immediate(), and set\+\_\+motor\+\_\+slew().

\mbox{\Hypertarget{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}\label{slew_8c_a69e0d1204ea4d87b7366c9cd79527984}} 
\index{slew.\+c@{slew.\+c}!motors\+\_\+curr\+\_\+speeds@{motors\+\_\+curr\+\_\+speeds}}
\index{motors\+\_\+curr\+\_\+speeds@{motors\+\_\+curr\+\_\+speeds}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{motors\+\_\+curr\+\_\+speeds}{motors\_curr\_speeds}}
{\footnotesize\ttfamily int motors\+\_\+curr\+\_\+speeds\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 7 of file slew.\+c.



Referenced by deinitslew(), init\+\_\+slew(), set\+\_\+motor\+\_\+immediate(), and update\+Motors().

\mbox{\Hypertarget{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}\label{slew_8c_acf7558ed17fdecd298ea7eb82291c7d0}} 
\index{slew.\+c@{slew.\+c}!motors\+\_\+set\+\_\+speeds@{motors\+\_\+set\+\_\+speeds}}
\index{motors\+\_\+set\+\_\+speeds@{motors\+\_\+set\+\_\+speeds}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{motors\+\_\+set\+\_\+speeds}{motors\_set\_speeds}}
{\footnotesize\ttfamily int motors\+\_\+set\+\_\+speeds\mbox{[}10\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 6 of file slew.\+c.



Referenced by deinitslew(), init\+\_\+slew(), set\+\_\+motor\+\_\+immediate(), set\+\_\+motor\+\_\+slew(), and update\+Motors().

\mbox{\Hypertarget{slew_8c_a9dc30877eadbb32ceb6bede027c9a93f}\label{slew_8c_a9dc30877eadbb32ceb6bede027c9a93f}} 
\index{slew.\+c@{slew.\+c}!slew@{slew}}
\index{slew@{slew}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{slew}{slew}}
{\footnotesize\ttfamily \hyperlink{_a_p_i_8h_a23dca3c0de10682afb982677ff292f77}{Task\+Handle} slew = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 9 of file slew.\+c.



Referenced by deinitslew(), and init\+\_\+slew().

\mbox{\Hypertarget{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}\label{slew_8c_a29ddd4c66a52ff81b441d04f9f6d9318}} 
\index{slew.\+c@{slew.\+c}!speeds\+\_\+mutex@{speeds\+\_\+mutex}}
\index{speeds\+\_\+mutex@{speeds\+\_\+mutex}!slew.\+c@{slew.\+c}}
\subsubsection{\texorpdfstring{speeds\+\_\+mutex}{speeds\_mutex}}
{\footnotesize\ttfamily \hyperlink{_a_p_i_8h_a9b40607ca13d2b5261f47f613e3c4fa4}{Mutex} speeds\+\_\+mutex\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 4 of file slew.\+c.



Referenced by init\+\_\+slew(), set\+\_\+motor\+\_\+immediate(), set\+\_\+motor\+\_\+slew(), and update\+Motors().

